; aLora - LoRaMesher-based direct messaging firmware
; - Feature selection is driven by build_flags inside each environment.
; - Add new pinmaps under include/pinmaps and select with APP_PINMAP_* flags.
; - OLED UI is portrait-first (rotation configurable).

[platformio]
default_envs = esp32s3

[env]
platform = espressif32@^6.11.0
framework = arduino
monitor_speed = 115200


board_build.flash_mode = qio
board_build.flash_size = 4MB

board_upload.flash_size = 4MB
board_upload.maximum_size = 4194304

board_build.filesystem = littlefs
board_build.partitions = default.csv

lib_deps =
  LoRaMesher@0.0.11
  olikraus/U8g2@^2.36.15
  igorantolic/AI ESP32 Rotary Encoder@^1.7.0
  thijse/ArduinoLog@^1.1.1

build_unflags =
  -std=gnu++11
  -std=gnu++14
  -std=c++11
  -std=c++14

build_flags =
  -std=gnu++17
  -Iinclude
  -D APP_BUILD_PIO=1
  -D APP_LOG_BAUD=115200
  -D APP_FS_LITTLEFS=1
  -D CORE_DEBUG_LEVEL=0

; -------------------------
; ESP32-S3 profile (your current build)
; -------------------------
[env:esp32s3]
board = esp32-s3-devkitc-1

build_flags =
  ${env.build_flags}
  -D APP_MCU_ESP32S3=1

  ; Pinmap selection (add more pinmaps and swap here)
  -D APP_PINMAP_SUPERMINI_S3=1

  ; Display selection
  -D APP_DISPLAY_OLED=1
  -D APP_OLED_WIDTH=128
  -D APP_OLED_HEIGHT=64
  ; 0=auto, 1306=SSD1306, 1315=SSD1315
  -D APP_OLED_CTRL=1315
  ; 0=auto, otherwise 0x3C or 0x3D
  -D APP_OLED_I2C_ADDR=0
  ; 0=R0 landscape, 1=R1 portrait CW, 2=R2, 3=R3 portrait CCW
  -D APP_OLED_ROT=1
  ; 100000 or 400000 typically
  -D APP_I2C_CLOCK_HZ=400000

  ; Input selection
  -D APP_ENABLE_ROTARY=1

  ; Radio selection (LoRaMesher + RadioLib)
  ; Supported: SX1278, SX1276, SX1262, SX1268, SX1280 (LoRaMesher 0.0.11 compatibility list)
  -D APP_LORA_MODULE_SX1278=1
  -D APP_LORA_FREQ_HZ=433000000
  -D APP_LORA_BW_KHZ=125
  -D APP_LORA_SF=12
  -D APP_LORA_TX_DBM=20
  -D APP_LORA_SYNCWORD=0x12
  -D APP_LORA_PREAMBLE=8

; -------------------------
; ESP32-C3 profile (placeholder)
; - You can clone the S3 flags and swap pinmap + peripherals.
; -------------------------
[env:esp32c3]
board = esp32-c3-devkitm-1
build_flags =
  ${env.build_flags}
  -D APP_MCU_ESP32C3=1
  -D APP_PINMAP_GENERIC_C3=1
  -D APP_DISPLAY_NONE=1
  -D APP_ENABLE_ROTARY=0
  -D APP_LORA_MODULE_SX1278=1
  -D APP_LORA_FREQ_HZ=433000000
  -D APP_LORA_BW_KHZ=125
  -D APP_LORA_SF=12
  -D APP_LORA_TX_DBM=20
  -D APP_LORA_SYNCWORD=0x12
  -D APP_LORA_PREAMBLE=8
